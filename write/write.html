<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vi·∫øt Th∆∞ | SecretLetter</title>

  <!-- Google Fonts (fix l·∫°i 1 d√≤ng g·ªçn g√†ng) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500&family=Inter:wght@400;500&family=Dancing+Script:wght@500&family=Great+Vibes&family=Pacifico&family=Lora&family=Merriweather&family=Montserrat&family=Raleway&family=Quicksand&family=Caveat&family=Indie+Flower&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="write.css">
</head>
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, doc, setDoc } 
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBznlEjaRHE7my7mFZTKgldokLGmkL609A",
  authDomain: "screctletters.firebaseapp.com",
  projectId: "screctletters",
  storageBucket: "screctletters.firebasestorage.app",
  messagingSenderId: "916940604225",
  appId: "1:916940604225:web:faf88856504271362ed7c0",
  measurementId: "G-KJFKX7M26P"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Cho write.js d√πng
window.db = db;
window.firebaseSetDoc = async (id, data) => {
  await setDoc(doc(db, "letters", id), data);
};

</script>
<body>

  <div class="background-blur"></div>

  <div class="card">
    <h1>Vi·∫øt m·ªôt l√° th∆∞ üíå</h1>

    <form id="letterForm">

      <!-- Ng∆∞·ªùi nh·∫≠n -->
      <div class="input-group">
        <label>Ng∆∞·ªùi nh·∫≠n</label>
        <input type="text" id="to" placeholder="V√≠ d·ª•: M·ªôt ng∆∞·ªùi ƒë·∫∑c bi·ªát..." required maxlength="100">
      </div>

      <!-- Ch·ªß ƒë·ªÅ -->
      <div class="input-group">
        <label>Ch·ªß ƒë·ªÅ</label>
        <input type="text" id="subject" placeholder="M·ªôt ƒëi·ªÅu m√¨nh mu·ªën n√≥i..." maxlength="150">
      </div>

      <!-- N·ªôi dung -->
      <div class="input-group">
        <label>N·ªôi dung</label>

        <!-- Toolbar -->
        <div class="toolbar">
          <button type="button" onclick="format('bold')"><b>B</b></button>
          <button type="button" onclick="format('italic')"><i>I</i></button>
          <button type="button" onclick="format('underline')"><u>U</u></button>

          <select onchange="setFont(this.value)">
            <option value="">Font ƒëo·∫°n</option>
            <option value="'Great Vibes'">Great Vibes</option>
            <option value="'Pacifico'">Pacifico</option>
            <option value="'Montserrat'">Montserrat</option>
            <option value="'Caveat'">Caveat</option>
          </select>

          <input type="color" onchange="setColor(this.value)">
        </div>

        <!-- Editor -->
        <div id="editor" contenteditable="true" class="editor"></div>
        <span id="charCount">0 / 2000</span>
      </div>

      <!-- Password + Expiry -->
      <div class="row">
        <div class="input-group half">
          <label>M·∫≠t kh·∫©u (tu·ª≥ ch·ªçn)</label>
          <input type="password" id="password" placeholder="ƒê·∫∑t m·∫≠t kh·∫©u">
        </div>

        <div class="input-group half">
          <label>Th·ªùi h·∫°n</label>
          <select id="expiry">
            <option value="1">1 ng√†y</option>
            <option value="7" selected>7 ng√†y</option>
            <option value="30">30 ng√†y</option>
            <option value="0">Vƒ©nh vi·ªÖn</option>
          </select>
        </div>
      </div>

      <!-- STYLE PANEL -->
      <div class="style-panel">
        <h3>Tu·ª≥ ch·ªânh phong c√°ch ‚ú®</h3>

        <div class="input-group">
          <label>Font to√†n th∆∞</label>
          <select id="fontFamily">
            <option value="'Playfair Display', serif">Playfair</option>
            <option value="'Inter', sans-serif">Inter</option>
            <option value="'Dancing Script', cursive">Dancing Script</option>
            <option value="'Great Vibes', cursive">Great Vibes</option>
            <option value="'Pacifico', cursive">Pacifico</option>
            <option value="'Lora', serif">Lora</option>
            <option value="'Merriweather', serif">Merriweather</option>
            <option value="'Montserrat', sans-serif">Montserrat</option>
            <option value="'Raleway', sans-serif">Raleway</option>
            <option value="'Quicksand', sans-serif">Quicksand</option>
            <option value="'Caveat', cursive">Caveat</option>
            <option value="'Indie Flower', cursive">Indie Flower</option>
          </select>
        </div>

        <div class="input-group">
          <label>C·ª° ch·ªØ: <span id="fontSizeValue">16px</span></label>
          <input type="range" id="fontSize" min="14" max="36" value="16">
        </div>

        <div class="input-group">
          <label>M√†u ch·ªØ</label>
          <input type="color" id="colorPicker" value="#ffffff">
          <input type="text" id="colorText" placeholder="#ff4d6d ho·∫∑c rgb(255,0,0)">
        </div>
      </div>

      <!-- PREVIEW -->
      <div class="preview">
        <h3>Xem tr∆∞·ªõc üëÄ</h3>
        <div id="previewText">
          N·ªôi dung th∆∞ c·ªßa b·∫°n s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...
        </div>
      </div>

      <!-- Submit -->
      <button type="submit" class="send-btn">
        T·∫°o li√™n k·∫øt b√≠ m·∫≠t ‚ú®
      </button>

    </form>
  </div>

  <script src="write.js"></script>
</body>
</html>